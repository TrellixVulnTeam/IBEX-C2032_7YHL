{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "import glob\n",
    "from collections import OrderedDict,defaultdict\n",
    "import pipes\n",
    "import pprint\n",
    "import tempfile\n",
    "import re"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "root_dir = 'bl6_rep1_data'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "####Fixed length 1e6 = 100 blocks. \n",
    "####Fixed length 5e5 = 200 blocks. \n",
    "Fixed_length = 2e6"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "def binary_locate(array,ele,start,end):\n",
    "    middle = (end+start)//2\n",
    "    if(end-start>1):\n",
    "        if(array[middle]<ele):\n",
    "            return binary_locate(array,ele,middle,end)\n",
    "        elif(array[middle+1]>ele):\n",
    "            return binary_locate(array,ele,start,middle)\n",
    "        else:\n",
    "            return middle,middle+1\n",
    "    else:\n",
    "        return middle,middle+1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "p = pipes.Template()\n",
    "p.append(\"zcat\", '--')\n",
    "Gene_Loc = defaultdict(list)\n",
    "#f = p.open('/home/longy/cnda/ensembl/Homo_sapiens.GRCh38.102.gtf.gz', 'r')\n",
    "\n",
    "f = p.open('/home/longy/cnda/ensembl/Mus_musculus.GRCm38.102.gtf.gz', 'r')\n",
    "for line in f.readlines():\n",
    "    if re.match('^#',line):\n",
    "        continue\n",
    "    line = line.rstrip('\\n')\n",
    "    data = line.split('\\t')\n",
    "    if(data[2] == 'gene'):\n",
    "        Gene_Loc['chr'+data[0]+data[6]].append(int(data[3]))\n",
    "        Gene_Loc['chr'+data[0]+data[6]].append(int(data[4]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(678, 679)"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import sys\n",
    "sys.setrecursionlimit(10000)\n",
    "array = Gene_Loc['chr1+']\n",
    "binary_locate(array,46104790,0,3505)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "writing file bl6_rep1_data/Blocks/chr15_+_0_3053635-35603423\n",
      "writing file bl6_rep1_data/Blocks/chr15_+_1_35606118-75032226\n",
      "writing file bl6_rep1_data/Blocks/chr15_+_2_75034254-86498526\n",
      "writing file bl6_rep1_data/Blocks/chr15_+_3_86499996-103828558\n",
      "writing file bl6_rep1_data/Blocks/chr15_-_0_3167231-36333508\n",
      "writing file bl6_rep1_data/Blocks/chr15_-_1_36342045-64383772\n",
      "writing file bl6_rep1_data/Blocks/chr15_-_2_64391788-79403286\n",
      "writing file bl6_rep1_data/Blocks/chr15_-_3_79413363-94543990\n",
      "writing file bl6_rep1_data/Blocks/chr15_-_4_94547865-103901353\n",
      "writing file bl6_rep1_data/Blocks/chr11_+_0_3123506-23502210\n",
      "writing file bl6_rep1_data/Blocks/chr11_+_1_23503978-50343734\n",
      "writing file bl6_rep1_data/Blocks/chr11_+_2_50345924-62181461\n",
      "writing file bl6_rep1_data/Blocks/chr11_+_3_62182836-75164471\n",
      "writing file bl6_rep1_data/Blocks/chr11_+_4_75165804-84296803\n",
      "writing file bl6_rep1_data/Blocks/chr11_+_5_84297976-98925398\n",
      "writing file bl6_rep1_data/Blocks/chr11_+_6_98930820-115433723\n",
      "writing file bl6_rep1_data/Blocks/chr11_+_7_115434861-121860060\n",
      "writing file bl6_rep1_data/Blocks/chr5_+_0_3016930-30963112\n",
      "writing file bl6_rep1_data/Blocks/chr5_+_1_30968903-48313787\n",
      "writing file bl6_rep1_data/Blocks/chr5_+_2_48325819-88657170\n",
      "writing file bl6_rep1_data/Blocks/chr5_+_3_88658436-110961442\n",
      "writing file bl6_rep1_data/Blocks/chr5_+_4_110965783-122314222\n",
      "writing file bl6_rep1_data/Blocks/chr5_+_5_122315311-138136990\n",
      "writing file bl6_rep1_data/Blocks/chr5_+_6_138142276-151648335\n",
      "writing file bl6_rep1_data/Blocks/chrX_-_0_3704476-52165383\n",
      "writing file bl6_rep1_data/Blocks/chrX_-_1_52210756-105007756\n",
      "writing file bl6_rep1_data/Blocks/chrX_-_2_105009884-170673449\n",
      "writing file bl6_rep1_data/Blocks/chr8_-_0_3080154-34147412\n",
      "writing file bl6_rep1_data/Blocks/chr8_-_1_34152543-70476997\n",
      "writing file bl6_rep1_data/Blocks/chr8_-_2_70481579-86746104\n",
      "writing file bl6_rep1_data/Blocks/chr8_-_3_86756514-111744743\n",
      "writing file bl6_rep1_data/Blocks/chr8_-_4_111746810-129292829\n",
      "writing file bl6_rep1_data/Blocks/chr18_-_0_3002425-34657506\n",
      "writing file bl6_rep1_data/Blocks/chr18_-_1_34728292-61726905\n",
      "writing file bl6_rep1_data/Blocks/chr18_-_2_61728861-90591630\n",
      "writing file bl6_rep1_data/Blocks/chr10_+_0_3366606-39568715\n",
      "writing file bl6_rep1_data/Blocks/chr10_+_1_39569833-67271840\n",
      "writing file bl6_rep1_data/Blocks/chr10_+_2_67274379-83200531\n",
      "writing file bl6_rep1_data/Blocks/chr10_+_3_83201913-108288739\n",
      "writing file bl6_rep1_data/Blocks/chr10_+_4_108289846-130586344\n",
      "writing file bl6_rep1_data/Blocks/chr7_-_0_3013375-27900713\n",
      "writing file bl6_rep1_data/Blocks/chr7_-_1_27903346-45155695\n",
      "writing file bl6_rep1_data/Blocks/chr7_-_2_45158203-79149093\n",
      "writing file bl6_rep1_data/Blocks/chr7_-_3_79280373-99125724\n",
      "writing file bl6_rep1_data/Blocks/chr7_-_4_99127505-114596011\n",
      "writing file bl6_rep1_data/Blocks/chr7_-_5_114705182-132317203\n",
      "writing file bl6_rep1_data/Blocks/chr7_-_6_132358752-145339940\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_0_3118375-28069892\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_1_28071183-35185214\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_2_35186686-70028426\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_3_70030099-101910502\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_4_101911722-122075842\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_5_122094480-148756773\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_6_148763159-160780784\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_7_160782036-181960283\n",
      "writing file bl6_rep1_data/Blocks/chr13_-_0_3137442-37995935\n",
      "writing file bl6_rep1_data/Blocks/chr13_-_1_37997182-55100302\n",
      "writing file bl6_rep1_data/Blocks/chr13_-_2_55112341-74364937\n",
      "writing file bl6_rep1_data/Blocks/chr13_-_3_74369309-103173063\n",
      "writing file bl6_rep1_data/Blocks/chr13_-_4_103175383-120304532\n",
      "writing file bl6_rep1_data/Blocks/chr2_-_0_3149151-26446298\n",
      "writing file bl6_rep1_data/Blocks/chr2_-_1_26453214-37748256\n",
      "writing file bl6_rep1_data/Blocks/chr2_-_2_37764231-73529839\n",
      "writing file bl6_rep1_data/Blocks/chr2_-_3_73564645-102901919\n",
      "writing file bl6_rep1_data/Blocks/chr2_-_4_102916101-122192687\n",
      "writing file bl6_rep1_data/Blocks/chr2_-_5_122203809-144270866\n",
      "writing file bl6_rep1_data/Blocks/chr2_-_6_144278033-163472660\n",
      "writing file bl6_rep1_data/Blocks/chr2_-_7_163516870-182005143\n",
      "writing file bl6_rep1_data/Blocks/chr6_-_0_3136134-37442293\n",
      "writing file bl6_rep1_data/Blocks/chr6_-_1_37453792-71908767\n",
      "writing file bl6_rep1_data/Blocks/chr6_-_2_71916202-89586599\n",
      "writing file bl6_rep1_data/Blocks/chr6_-_3_89588425-112947281\n",
      "writing file bl6_rep1_data/Blocks/chr6_-_4_112951092-128143575\n",
      "writing file bl6_rep1_data/Blocks/chr6_-_5_128163560-149559879\n",
      "writing file bl6_rep1_data/Blocks/chr12_-_0_3006312-51692356\n",
      "writing file bl6_rep1_data/Blocks/chr12_-_1_51708588-80260812\n",
      "writing file bl6_rep1_data/Blocks/chr12_-_2_80263470-100379565\n",
      "writing file bl6_rep1_data/Blocks/chr12_-_3_100380570-119876462\n",
      "writing file bl6_rep1_data/Blocks/chr17_-_0_3040727-25015808\n",
      "writing file bl6_rep1_data/Blocks/chr17_-_1_25033082-34850981\n",
      "writing file bl6_rep1_data/Blocks/chr17_-_2_34852321-56167083\n",
      "writing file bl6_rep1_data/Blocks/chr17_-_3_56171465-74329921\n",
      "writing file bl6_rep1_data/Blocks/chr17_-_4_74332300-94864638\n",
      "writing file bl6_rep1_data/Blocks/chr19_+_0_3033537-18894289\n",
      "writing file bl6_rep1_data/Blocks/chr19_+_1_19958894-44985157\n",
      "writing file bl6_rep1_data/Blocks/chr19_+_2_44989850-61270418\n",
      "writing file bl6_rep1_data/Blocks/chr10_-_0_3140512-23788372\n",
      "writing file bl6_rep1_data/Blocks/chr10_-_1_23795957-54125809\n",
      "writing file bl6_rep1_data/Blocks/chr10_-_2_54137644-76442853\n",
      "writing file bl6_rep1_data/Blocks/chr10_-_3_76453703-85185308\n",
      "writing file bl6_rep1_data/Blocks/chr10_-_4_85229564-117320705\n",
      "writing file bl6_rep1_data/Blocks/chr10_-_5_117322371-130592799\n",
      "writing file bl6_rep1_data/Blocks/chr1_-_0_3063366-37873403\n",
      "writing file bl6_rep1_data/Blocks/chr1_-_1_37874825-60098711\n",
      "writing file bl6_rep1_data/Blocks/chr1_-_2_60107488-84840647\n",
      "writing file bl6_rep1_data/Blocks/chr1_-_3_84880887-125930471\n",
      "writing file bl6_rep1_data/Blocks/chr1_-_4_125931575-143708752\n",
      "writing file bl6_rep1_data/Blocks/chr1_-_5_143735046-163189519\n",
      "writing file bl6_rep1_data/Blocks/chr1_-_6_163191002-179803689\n",
      "writing file bl6_rep1_data/Blocks/chr1_-_7_179829362-195329697\n",
      "writing file bl6_rep1_data/Blocks/chr18_+_0_3142377-31801083\n",
      "writing file bl6_rep1_data/Blocks/chr18_+_1_31804070-44894931\n",
      "writing file bl6_rep1_data/Blocks/chr18_+_2_45029552-67407977\n",
      "writing file bl6_rep1_data/Blocks/chr18_+_3_67409213-90600877\n",
      "writing file bl6_rep1_data/Blocks/chr7_+_0_3102181-27917138\n",
      "writing file bl6_rep1_data/Blocks/chr7_+_1_27918163-49613184\n",
      "writing file bl6_rep1_data/Blocks/chr7_+_2_49615111-80167777\n",
      "writing file bl6_rep1_data/Blocks/chr7_+_3_80186862-98724686\n",
      "writing file bl6_rep1_data/Blocks/chr7_+_4_98730008-112910463\n",
      "writing file bl6_rep1_data/Blocks/chr7_+_5_112911603-130770309\n",
      "writing file bl6_rep1_data/Blocks/chr7_+_6_130771671-145326079\n",
      "writing file bl6_rep1_data/Blocks/chr19_-_0_3033502-16047872\n",
      "writing file bl6_rep1_data/Blocks/chr19_-_1_16083459-41423608\n",
      "writing file bl6_rep1_data/Blocks/chr19_-_2_41443755-61323291\n",
      "writing file bl6_rep1_data/Blocks/chr4_+_0_3376312-41040195\n",
      "writing file bl6_rep1_data/Blocks/chr4_+_1_41041360-57810993\n",
      "writing file bl6_rep1_data/Blocks/chr4_+_2_57812130-99121813\n",
      "writing file bl6_rep1_data/Blocks/chr4_+_3_99123974-116542442\n",
      "writing file bl6_rep1_data/Blocks/chr4_+_4_116543569-130782864\n",
      "writing file bl6_rep1_data/Blocks/chr4_+_5_130784377-141332422\n",
      "writing file bl6_rep1_data/Blocks/chr4_+_6_141371078-156318405\n",
      "writing file bl6_rep1_data/Blocks/chr1_+_0_3279785-40372196\n",
      "writing file bl6_rep1_data/Blocks/chr1_+_1_40376538-63974146\n",
      "writing file bl6_rep1_data/Blocks/chr1_+_2_63975396-87965277\n",
      "writing file bl6_rep1_data/Blocks/chr1_+_3_87967435-125596542\n",
      "writing file bl6_rep1_data/Blocks/chr1_+_4_125598135-151726319\n",
      "writing file bl6_rep1_data/Blocks/chr1_+_5_151727327-178264102\n",
      "writing file bl6_rep1_data/Blocks/chr1_+_6_178265231-195323771\n",
      "writing file bl6_rep1_data/Blocks/chr14_+_0_3055087-27212153\n",
      "writing file bl6_rep1_data/Blocks/chr14_+_1_27216828-54601230\n",
      "writing file bl6_rep1_data/Blocks/chr14_+_2_54603106-76508134\n",
      "writing file bl6_rep1_data/Blocks/chr14_+_3_76509714-124369088\n",
      "writing file bl6_rep1_data/Blocks/chr4_-_0_3087276-44233644\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "writing file bl6_rep1_data/Blocks/chr4_-_1_44243188-82790716\n",
      "writing file bl6_rep1_data/Blocks/chr4_-_2_82792041-115238505\n",
      "writing file bl6_rep1_data/Blocks/chr4_-_3_115239853-129672781\n",
      "writing file bl6_rep1_data/Blocks/chr4_-_4_129674844-141539050\n",
      "writing file bl6_rep1_data/Blocks/chr4_-_5_141576043-156252068\n",
      "writing file bl6_rep1_data/Blocks/chr13_+_0_3043636-37955500\n",
      "writing file bl6_rep1_data/Blocks/chr13_+_1_37957070-63881468\n",
      "writing file bl6_rep1_data/Blocks/chr13_+_2_63882473-96419003\n",
      "writing file bl6_rep1_data/Blocks/chr13_+_3_96420255-120304378\n",
      "writing file bl6_rep1_data/Blocks/chr14_-_0_3051637-32342956\n",
      "writing file bl6_rep1_data/Blocks/chr14_-_1_32344889-57828195\n",
      "writing file bl6_rep1_data/Blocks/chr14_-_2_57829799-74549952\n",
      "writing file bl6_rep1_data/Blocks/chr14_-_3_74607916-124689347\n",
      "writing file bl6_rep1_data/Blocks/chr17_+_0_3055606-15775699\n",
      "writing file bl6_rep1_data/Blocks/chr17_+_1_15797501-28333691\n",
      "writing file bl6_rep1_data/Blocks/chr17_+_2_28334956-46422949\n",
      "writing file bl6_rep1_data/Blocks/chr17_+_3_46424120-74709550\n",
      "writing file bl6_rep1_data/Blocks/chr17_+_4_74717761-94879788\n",
      "writing file bl6_rep1_data/Blocks/chr16_-_0_3042415-17919315\n",
      "writing file bl6_rep1_data/Blocks/chr16_-_1_17922943-34574403\n",
      "writing file bl6_rep1_data/Blocks/chr16_-_2_34587541-65562754\n",
      "writing file bl6_rep1_data/Blocks/chr16_-_3_65787209-98082503\n",
      "writing file bl6_rep1_data/Blocks/chr9_+_0_3316787-23488134\n",
      "writing file bl6_rep1_data/Blocks/chr9_+_1_23490175-46226724\n",
      "writing file bl6_rep1_data/Blocks/chr9_+_2_46227729-61964911\n",
      "writing file bl6_rep1_data/Blocks/chr9_+_3_61966032-72629988\n",
      "writing file bl6_rep1_data/Blocks/chr9_+_4_72632967-99315250\n",
      "writing file bl6_rep1_data/Blocks/chr9_+_5_99317943-110620990\n",
      "writing file bl6_rep1_data/Blocks/chr9_+_6_110622463-124475646\n",
      "writing file bl6_rep1_data/Blocks/chr8_+_0_3118927-26989112\n",
      "writing file bl6_rep1_data/Blocks/chr8_+_1_26992126-69872604\n",
      "writing file bl6_rep1_data/Blocks/chr8_+_2_69887336-86045512\n",
      "writing file bl6_rep1_data/Blocks/chr8_+_3_86046818-106428850\n",
      "writing file bl6_rep1_data/Blocks/chr8_+_4_106429897-120058905\n",
      "writing file bl6_rep1_data/Blocks/chr8_+_5_120059936-129294159\n",
      "writing file bl6_rep1_data/Blocks/chr3_+_0_3345182-37582967\n",
      "writing file bl6_rep1_data/Blocks/chr3_+_1_37584215-69038427\n",
      "writing file bl6_rep1_data/Blocks/chr3_+_2_69039674-90369597\n",
      "writing file bl6_rep1_data/Blocks/chr3_+_3_90372765-104029025\n",
      "writing file bl6_rep1_data/Blocks/chr3_+_4_104030810-135276154\n",
      "writing file bl6_rep1_data/Blocks/chr3_+_5_135281283-159938934\n",
      "writing file bl6_rep1_data/Blocks/chr9_-_0_3002699-35268171\n",
      "writing file bl6_rep1_data/Blocks/chr9_-_1_35271832-53248092\n",
      "writing file bl6_rep1_data/Blocks/chr9_-_2_53270820-64737784\n",
      "writing file bl6_rep1_data/Blocks/chr9_-_3_64741666-87394233\n",
      "writing file bl6_rep1_data/Blocks/chr9_-_4_87473345-108284085\n",
      "writing file bl6_rep1_data/Blocks/chr9_-_5_108287622-124494485\n",
      "writing file bl6_rep1_data/Blocks/chrX_+_0_3456134-56796676\n",
      "writing file bl6_rep1_data/Blocks/chrX_+_1_56798351-99157743\n",
      "writing file bl6_rep1_data/Blocks/chrX_+_2_99159604-142753344\n",
      "writing file bl6_rep1_data/Blocks/chrX_+_3_142754688-170677766\n",
      "writing file bl6_rep1_data/Blocks/chr6_+_0_3200780-31387100\n",
      "writing file bl6_rep1_data/Blocks/chr6_+_1_31388730-52770665\n",
      "writing file bl6_rep1_data/Blocks/chr6_+_2_52772140-84220267\n",
      "writing file bl6_rep1_data/Blocks/chr6_+_3_84221549-113162750\n",
      "writing file bl6_rep1_data/Blocks/chr6_+_4_113165419-134213069\n",
      "writing file bl6_rep1_data/Blocks/chr6_+_5_134214568-149585979\n",
      "writing file bl6_rep1_data/Blocks/chr12_+_0_3008348-24964402\n",
      "writing file bl6_rep1_data/Blocks/chr12_+_1_24965471-69478210\n",
      "writing file bl6_rep1_data/Blocks/chr12_+_2_69479509-82451928\n",
      "writing file bl6_rep1_data/Blocks/chr12_+_3_82453108-108548168\n",
      "writing file bl6_rep1_data/Blocks/chr12_+_4_108549857-119876782\n",
      "writing file bl6_rep1_data/Blocks/chr16_+_0_3042517-18976122\n",
      "writing file bl6_rep1_data/Blocks/chr16_+_1_18983580-33243754\n",
      "writing file bl6_rep1_data/Blocks/chr16_+_2_33246017-52210565\n",
      "writing file bl6_rep1_data/Blocks/chr16_+_3_52211595-98102920\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_0_3102283-20283359\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_1_20286574-48011812\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_2_48289843-61579712\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_3_61591684-75207215\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_4_75253628-84880932\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_5_84888091-96830422\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_6_96841348-103954019\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_7_103962594-115708596\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_8_115724328-121945312\n",
      "writing file bl6_rep1_data/Blocks/chr5_-_0_3182432-31486276\n",
      "writing file bl6_rep1_data/Blocks/chr5_-_1_31506178-62874984\n",
      "writing file bl6_rep1_data/Blocks/chr5_-_2_63077726-92352769\n",
      "writing file bl6_rep1_data/Blocks/chr5_-_3_92406585-113775316\n",
      "writing file bl6_rep1_data/Blocks/chr5_-_4_113776732-124868918\n",
      "writing file bl6_rep1_data/Blocks/chr5_-_5_124880316-139775643\n",
      "writing file bl6_rep1_data/Blocks/chr5_-_6_139783331-151683797\n",
      "writing file bl6_rep1_data/Blocks/chr3_-_0_3633343-41625156\n",
      "writing file bl6_rep1_data/Blocks/chr3_-_1_41626183-85983263\n",
      "writing file bl6_rep1_data/Blocks/chr3_-_2_86040001-102354523\n",
      "writing file bl6_rep1_data/Blocks/chr3_-_3_102363990-129970568\n",
      "writing file bl6_rep1_data/Blocks/chr3_-_4_129974058-159937567\n"
     ]
    }
   ],
   "source": [
    "total = 0\n",
    "files = glob.glob(root_dir+\"/*.txt\")\n",
    "info = open(root_dir+'/Blocks/info.txt','w')\n",
    "info.write('ID\\tstart\\tend\\tlength\\tsites_num\\n')\n",
    "for file in files:\n",
    "    num_lines = sum(1 for line in open(file))\n",
    "    num_blocks = round(num_lines/Fixed_length)\n",
    "    len_blocks = num_lines/num_blocks\n",
    "    \n",
    "    f= open(file,'r')\n",
    "    pre_pos = 0\n",
    "    dict_line = OrderedDict()\n",
    "    #dict_line = dict()\n",
    "    count = 0\n",
    "    separate_num=0\n",
    "    save_block = 0\n",
    "    start = 0\n",
    "    \n",
    "    for i, line in enumerate(f):\n",
    "        line = line.rstrip('\\n')\n",
    "        if(i==0):\n",
    "            continue ###Skip header\n",
    "        chromosome,pos,strand = line.split('\\t')[0].split(':')\n",
    "        pos = int(pos)\n",
    "        count += 1\n",
    "        if(i==1):\n",
    "            start=pos\n",
    "        if(count>len_blocks and pos-pre_pos>1000 and save_block<num_blocks-1):\n",
    "            array = Gene_Loc[chromosome+strand]\n",
    "            index1,index2 = binary_locate(array,pre_pos,0,len(array)-1)\n",
    "            if(index1%2==1 and index2%2==0):\n",
    "                ww = open(root_dir+'/Blocks/%s_%s_%d'%(chromosome,strand,save_block),'w')\n",
    "                print('writing file '+root_dir+'/Blocks/%s_%s_%d_%d-%d'%(chromosome,strand,save_block,start,pre_pos))\n",
    "                info.write('%s_%s_%d\\t%d\\t%d\\t%d\\t%d\\n'%(chromosome,strand,save_block,start,pre_pos,pre_pos-start,count))\n",
    "                #print('%s_%s_%d\\t%d\\t%d\\t%d\\t%d\\n'%(chromosome,strand,save_block,start,pre_pos,pre_pos-start,count))\n",
    "                for key,val in dict_line.items():\n",
    "                    ww.write('%s\\n'%val)\n",
    "                ww.close()\n",
    "                dict_line.clear()\n",
    "                count = 0\n",
    "                save_block += 1\n",
    "                start  = pos\n",
    "            \n",
    "        \n",
    "        dict_line[pos] = line\n",
    "        pre_pos = pos\n",
    "        \n",
    "    out = open(root_dir+'/Blocks/%s_%s_%d'%(chromosome,strand,save_block),'w')\n",
    "    print('writing file '+root_dir+'/Blocks/%s_%s_%d_%d-%d'%(chromosome,strand,save_block,start,pre_pos))\n",
    "    info.write('%s_%s_%d\\t%d\\t%d\\t%d\\t%d\\n'%(chromosome,strand,save_block,start,pre_pos,pre_pos-start,count))\n",
    "    for key,val in dict_line.items():\n",
    "        out.write('%s\\n'%(val))\n",
    "    out.close()\n",
    "\n",
    "info.close()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
