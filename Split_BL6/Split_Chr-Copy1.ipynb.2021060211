{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "import glob\n",
    "from collections import OrderedDict,defaultdict\n",
    "import pipes\n",
    "import pprint\n",
    "import tempfile\n",
    "import re"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "root_dir = 'bl6_rep1_data'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "####Fixed length 1e6 = 100 blocks. \n",
    "####Fixed length 5e5 = 200 blocks. \n",
    "Fixed_length = 2e6"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "def binary_locate(array,ele,start,end):\n",
    "    middle = (end+start)//2\n",
    "    if(end-start>1):\n",
    "        if(array[middle]<ele):\n",
    "            return binary_locate(array,ele,middle,end)\n",
    "        elif(array[middle+1]>ele):\n",
    "            return binary_locate(array,ele,start,middle)\n",
    "        else:\n",
    "            return middle,middle+1\n",
    "    else:\n",
    "        return middle,middle+1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "p = pipes.Template()\n",
    "p.append(\"zcat\", '--')\n",
    "Gene_Loc = defaultdict(list)\n",
    "#f = p.open('/home/longy/cnda/ensembl/Homo_sapiens.GRCh38.102.gtf.gz', 'r')\n",
    "\n",
    "f = p.open('/home/longy/cnda/ensembl/Mus_musculus.GRCm38.102.gtf.gz', 'r')\n",
    "for line in f.readlines():\n",
    "    if re.match('^#',line):\n",
    "        continue\n",
    "    line = line.rstrip('\\n')\n",
    "    data = line.split('\\t')\n",
    "    if(data[2] == 'gene'):\n",
    "        Gene_Loc['chr'+data[0]+data[6]].append(int(data[3]))\n",
    "        Gene_Loc['chr'+data[0]+data[6]].append(int(data[4]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(678, 679)"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import sys\n",
    "sys.setrecursionlimit(10000)\n",
    "array = Gene_Loc['chr1+']\n",
    "binary_locate(array,46104790,0,3505)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "writing file bl6_rep1_data/Blocks/chr18_-_0_3002428-34657526\n",
      "writing file bl6_rep1_data/Blocks/chr18_-_1_34728295-61726925\n",
      "writing file bl6_rep1_data/Blocks/chr18_-_2_61728864-90578245\n",
      "writing file bl6_rep1_data/Blocks/chr1_+_0_3279765-40372193\n",
      "writing file bl6_rep1_data/Blocks/chr1_+_1_40376518-63760737\n",
      "writing file bl6_rep1_data/Blocks/chr1_+_2_63770489-87965274\n",
      "writing file bl6_rep1_data/Blocks/chr1_+_3_87967415-125596539\n",
      "writing file bl6_rep1_data/Blocks/chr1_+_4_125598115-151727632\n",
      "writing file bl6_rep1_data/Blocks/chr1_+_5_151739613-178264099\n",
      "writing file bl6_rep1_data/Blocks/chr1_+_6_178265211-195241907\n",
      "writing file bl6_rep1_data/Blocks/chr10_+_0_3366586-28598446\n",
      "writing file bl6_rep1_data/Blocks/chr10_+_1_28602010-58565264\n",
      "writing file bl6_rep1_data/Blocks/chr10_+_2_58570378-77062471\n",
      "writing file bl6_rep1_data/Blocks/chr10_+_3_77064997-84736390\n",
      "writing file bl6_rep1_data/Blocks/chr10_+_4_84739017-108288736\n",
      "writing file bl6_rep1_data/Blocks/chr10_+_5_108289826-130586294\n",
      "writing file bl6_rep1_data/Blocks/chr6_+_0_3200760-31387097\n",
      "writing file bl6_rep1_data/Blocks/chr6_+_1_31388710-52770662\n",
      "writing file bl6_rep1_data/Blocks/chr6_+_2_52772120-84220264\n",
      "writing file bl6_rep1_data/Blocks/chr6_+_3_84221529-113162747\n",
      "writing file bl6_rep1_data/Blocks/chr6_+_4_113165399-134213066\n",
      "writing file bl6_rep1_data/Blocks/chr6_+_5_134214548-149585799\n",
      "writing file bl6_rep1_data/Blocks/chr4_-_0_3087279-41774658\n",
      "writing file bl6_rep1_data/Blocks/chr4_-_1_41784678-62525361\n",
      "writing file bl6_rep1_data/Blocks/chr4_-_2_62536819-99962198\n",
      "writing file bl6_rep1_data/Blocks/chr4_-_3_99963498-120812033\n",
      "writing file bl6_rep1_data/Blocks/chr4_-_4_120813126-133277856\n",
      "writing file bl6_rep1_data/Blocks/chr4_-_5_133279578-143212959\n",
      "writing file bl6_rep1_data/Blocks/chr4_-_6_143220954-156252080\n",
      "writing file bl6_rep1_data/Blocks/chr11_+_0_3123486-23502207\n",
      "writing file bl6_rep1_data/Blocks/chr11_+_1_23503958-50301891\n",
      "writing file bl6_rep1_data/Blocks/chr11_+_2_50303343-62181458\n",
      "writing file bl6_rep1_data/Blocks/chr11_+_3_62182816-75164468\n",
      "writing file bl6_rep1_data/Blocks/chr11_+_4_75165784-84296800\n",
      "writing file bl6_rep1_data/Blocks/chr11_+_5_84297956-98925395\n",
      "writing file bl6_rep1_data/Blocks/chr11_+_6_98930800-115400293\n",
      "writing file bl6_rep1_data/Blocks/chr11_+_7_115401298-121859676\n",
      "writing file bl6_rep1_data/Blocks/chr14_+_0_3055067-27212150\n",
      "writing file bl6_rep1_data/Blocks/chr14_+_1_27216808-54634201\n",
      "writing file bl6_rep1_data/Blocks/chr14_+_2_54635696-76508131\n",
      "writing file bl6_rep1_data/Blocks/chr14_+_3_76509694-124369085\n",
      "writing file bl6_rep1_data/Blocks/chr12_-_0_3006315-51692376\n",
      "writing file bl6_rep1_data/Blocks/chr12_-_1_51708591-80260832\n",
      "writing file bl6_rep1_data/Blocks/chr12_-_2_80263473-100432771\n",
      "writing file bl6_rep1_data/Blocks/chr12_-_3_100434268-119867403\n",
      "writing file bl6_rep1_data/Blocks/chr15_+_0_3053615-35603420\n",
      "writing file bl6_rep1_data/Blocks/chr15_+_1_35606098-74749160\n",
      "writing file bl6_rep1_data/Blocks/chr15_+_2_74750676-86498523\n",
      "writing file bl6_rep1_data/Blocks/chr15_+_3_86499976-103828508\n",
      "writing file bl6_rep1_data/Blocks/chr5_-_0_3182435-31296366\n",
      "writing file bl6_rep1_data/Blocks/chr5_-_1_31299045-62736732\n",
      "writing file bl6_rep1_data/Blocks/chr5_-_2_62738139-92352789\n",
      "writing file bl6_rep1_data/Blocks/chr5_-_3_92406588-113775336\n",
      "writing file bl6_rep1_data/Blocks/chr5_-_4_113776735-124899976\n",
      "writing file bl6_rep1_data/Blocks/chr5_-_5_124940711-139826902\n",
      "writing file bl6_rep1_data/Blocks/chr5_-_6_139860620-151683747\n",
      "writing file bl6_rep1_data/Blocks/chr14_-_0_3051640-32201935\n",
      "writing file bl6_rep1_data/Blocks/chr14_-_1_32208868-57890308\n",
      "writing file bl6_rep1_data/Blocks/chr14_-_2_57899903-74992225\n",
      "writing file bl6_rep1_data/Blocks/chr14_-_3_75013437-124689297\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_0_3118355-27538853\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_1_27540396-32256686\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_2_32258082-59857271\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_3_59858450-84865056\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_4_84867785-117279015\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_5_117280589-129128528\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_6_129129688-152947277\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_7_152948535-164144643\n",
      "writing file bl6_rep1_data/Blocks/chr2_+_8_164145804-181960280\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_0_3102286-20283379\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_1_20286577-48011832\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_2_48289846-61579732\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_3_61591687-75207235\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_4_75253631-84880952\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_5_84888094-96830442\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_6_96841351-103954039\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_7_103962597-115708616\n",
      "writing file bl6_rep1_data/Blocks/chr11_-_8_115724331-121945332\n",
      "writing file bl6_rep1_data/Blocks/chr10_-_0_3140515-23569376\n",
      "writing file bl6_rep1_data/Blocks/chr10_-_1_23573008-53623306\n",
      "writing file bl6_rep1_data/Blocks/chr10_-_2_53624368-76346029\n",
      "writing file bl6_rep1_data/Blocks/chr10_-_3_76347396-84505545\n",
      "writing file bl6_rep1_data/Blocks/chr10_-_4_84507153-117064939\n",
      "writing file bl6_rep1_data/Blocks/chr10_-_5_117066964-130592749\n",
      "writing file bl6_rep1_data/Blocks/chr4_+_0_3376292-41040192\n",
      "writing file bl6_rep1_data/Blocks/chr4_+_1_41041340-57810990\n",
      "writing file bl6_rep1_data/Blocks/chr4_+_2_57812110-98674408\n",
      "writing file bl6_rep1_data/Blocks/chr4_+_3_98676165-116303180\n",
      "writing file bl6_rep1_data/Blocks/chr4_+_4_116304373-130782861\n",
      "writing file bl6_rep1_data/Blocks/chr4_+_5_130784357-141332419\n",
      "writing file bl6_rep1_data/Blocks/chr4_+_6_141371058-156318402\n",
      "writing file bl6_rep1_data/Blocks/chr19_+_0_3033517-20445337\n",
      "writing file bl6_rep1_data/Blocks/chr19_+_1_20446572-44985154\n",
      "writing file bl6_rep1_data/Blocks/chr19_+_2_44989830-61270415\n",
      "writing file bl6_rep1_data/Blocks/chr2_-_0_3149154-26446318\n",
      "writing file bl6_rep1_data/Blocks/chr2_-_1_26453217-38016067\n",
      "writing file bl6_rep1_data/Blocks/chr2_-_2_38018794-73868979\n",
      "writing file bl6_rep1_data/Blocks/chr2_-_3_73870278-102901939\n",
      "writing file bl6_rep1_data/Blocks/chr2_-_4_102916104-122118392\n",
      "writing file bl6_rep1_data/Blocks/chr2_-_5_122147198-144539780\n",
      "writing file bl6_rep1_data/Blocks/chr2_-_6_144541347-163645168\n",
      "writing file bl6_rep1_data/Blocks/chr2_-_7_163658502-182005163\n",
      "writing file bl6_rep1_data/Blocks/chr19_-_0_3033505-8798701\n",
      "writing file bl6_rep1_data/Blocks/chr19_-_1_8802512-31765106\n",
      "writing file bl6_rep1_data/Blocks/chr19_-_2_31925563-45789578\n",
      "writing file bl6_rep1_data/Blocks/chr19_-_3_45790937-61305252\n",
      "writing file bl6_rep1_data/Blocks/chr1_-_0_3063369-37527436\n",
      "writing file bl6_rep1_data/Blocks/chr1_-_1_37531742-59671043\n",
      "writing file bl6_rep1_data/Blocks/chr1_-_2_59685083-82729444\n",
      "writing file bl6_rep1_data/Blocks/chr1_-_3_82731093-121430574\n",
      "writing file bl6_rep1_data/Blocks/chr1_-_4_121438606-138607526\n",
      "writing file bl6_rep1_data/Blocks/chr1_-_5_138608573-162087144\n",
      "writing file bl6_rep1_data/Blocks/chr1_-_6_162089021-179520886\n",
      "writing file bl6_rep1_data/Blocks/chr1_-_7_179523065-195326213\n",
      "writing file bl6_rep1_data/Blocks/chr12_+_0_3008328-24964399\n",
      "writing file bl6_rep1_data/Blocks/chr12_+_1_24965451-69381016\n",
      "writing file bl6_rep1_data/Blocks/chr12_+_2_69382275-82002382\n",
      "writing file bl6_rep1_data/Blocks/chr12_+_3_82031785-105859186\n",
      "writing file bl6_rep1_data/Blocks/chr12_+_4_105860549-119876779\n",
      "writing file bl6_rep1_data/Blocks/chr3_+_0_3345162-37582964\n",
      "writing file bl6_rep1_data/Blocks/chr3_+_1_37584195-68903142\n",
      "writing file bl6_rep1_data/Blocks/chr3_+_2_68905486-90369594\n",
      "writing file bl6_rep1_data/Blocks/chr3_+_3_90372745-104029022\n",
      "writing file bl6_rep1_data/Blocks/chr3_+_4_104030790-133379882\n",
      "writing file bl6_rep1_data/Blocks/chr3_+_5_133387701-159938884\n",
      "writing file bl6_rep1_data/Blocks/chr9_+_0_3316767-23488131\n",
      "writing file bl6_rep1_data/Blocks/chr9_+_1_23490155-46227838\n",
      "writing file bl6_rep1_data/Blocks/chr9_+_2_46229750-61964908\n",
      "writing file bl6_rep1_data/Blocks/chr9_+_3_61966012-72629985\n",
      "writing file bl6_rep1_data/Blocks/chr9_+_4_72632947-99315247\n",
      "writing file bl6_rep1_data/Blocks/chr9_+_5_99317923-110620987\n",
      "writing file bl6_rep1_data/Blocks/chr9_+_6_110622443-124475596\n",
      "writing file bl6_rep1_data/Blocks/chr16_-_0_3042418-17911356\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "writing file bl6_rep1_data/Blocks/chr16_-_1_17919211-34574423\n",
      "writing file bl6_rep1_data/Blocks/chr16_-_2_34587544-65236071\n",
      "writing file bl6_rep1_data/Blocks/chr16_-_3_65451381-98082453\n",
      "writing file bl6_rep1_data/Blocks/chr6_-_0_3136137-37442313\n",
      "writing file bl6_rep1_data/Blocks/chr6_-_1_37453795-71908787\n",
      "writing file bl6_rep1_data/Blocks/chr6_-_2_71916205-89860315\n",
      "writing file bl6_rep1_data/Blocks/chr6_-_3_89862364-112947301\n",
      "writing file bl6_rep1_data/Blocks/chr6_-_4_112951095-128143595\n",
      "writing file bl6_rep1_data/Blocks/chr6_-_5_128163563-149434347\n",
      "writing file bl6_rep1_data/Blocks/chr13_-_0_3137445-37995955\n",
      "writing file bl6_rep1_data/Blocks/chr13_-_1_37997185-55100322\n",
      "writing file bl6_rep1_data/Blocks/chr13_-_2_55112344-74390829\n",
      "writing file bl6_rep1_data/Blocks/chr13_-_3_74414076-103173083\n",
      "writing file bl6_rep1_data/Blocks/chr13_-_4_103175386-120304482\n",
      "writing file bl6_rep1_data/Blocks/chr17_+_0_3055586-15775696\n",
      "writing file bl6_rep1_data/Blocks/chr17_+_1_15797481-28399428\n",
      "writing file bl6_rep1_data/Blocks/chr17_+_2_28401024-46422946\n",
      "writing file bl6_rep1_data/Blocks/chr17_+_3_46424100-74503598\n",
      "writing file bl6_rep1_data/Blocks/chr17_+_4_74504701-94879738\n",
      "writing file bl6_rep1_data/Blocks/chr15_-_0_3167234-36266858\n",
      "writing file bl6_rep1_data/Blocks/chr15_-_1_36269187-64383792\n",
      "writing file bl6_rep1_data/Blocks/chr15_-_2_64391791-79403306\n",
      "writing file bl6_rep1_data/Blocks/chr15_-_3_79413366-94544010\n",
      "writing file bl6_rep1_data/Blocks/chr15_-_4_94547868-103900797\n",
      "writing file bl6_rep1_data/Blocks/chr9_-_0_3002098-35268191\n",
      "writing file bl6_rep1_data/Blocks/chr9_-_1_35271835-53248112\n",
      "writing file bl6_rep1_data/Blocks/chr9_-_2_53270823-64737804\n",
      "writing file bl6_rep1_data/Blocks/chr9_-_3_64741669-87394253\n",
      "writing file bl6_rep1_data/Blocks/chr9_-_4_87473348-108290470\n",
      "writing file bl6_rep1_data/Blocks/chr9_-_5_108295614-124476937\n",
      "writing file bl6_rep1_data/Blocks/chr16_+_0_3042497-18976119\n",
      "writing file bl6_rep1_data/Blocks/chr16_+_1_18983560-33243751\n",
      "writing file bl6_rep1_data/Blocks/chr16_+_2_33245997-52210562\n",
      "writing file bl6_rep1_data/Blocks/chr16_+_3_52211575-98102917\n",
      "writing file bl6_rep1_data/Blocks/chrX_+_0_3456114-56796673\n",
      "writing file bl6_rep1_data/Blocks/chrX_+_1_56798331-99075498\n",
      "writing file bl6_rep1_data/Blocks/chrX_+_2_99076580-142753341\n",
      "writing file bl6_rep1_data/Blocks/chrX_+_3_142754668-170677468\n",
      "writing file bl6_rep1_data/Blocks/chrX_-_0_3704479-52165403\n",
      "writing file bl6_rep1_data/Blocks/chrX_-_1_52210759-104996754\n",
      "writing file bl6_rep1_data/Blocks/chrX_-_2_104998166-170673399\n",
      "writing file bl6_rep1_data/Blocks/chr5_+_0_3016910-30932127\n",
      "writing file bl6_rep1_data/Blocks/chr5_+_1_30933578-48307751\n",
      "writing file bl6_rep1_data/Blocks/chr5_+_2_48313476-88657167\n",
      "writing file bl6_rep1_data/Blocks/chr5_+_3_88658416-110961439\n",
      "writing file bl6_rep1_data/Blocks/chr5_+_4_110965763-122314219\n",
      "writing file bl6_rep1_data/Blocks/chr5_+_5_122315291-138136987\n",
      "writing file bl6_rep1_data/Blocks/chr5_+_6_138142256-151648332\n",
      "writing file bl6_rep1_data/Blocks/chr3_-_0_3633346-35942505\n",
      "writing file bl6_rep1_data/Blocks/chr3_-_1_35943576-75956965\n",
      "writing file bl6_rep1_data/Blocks/chr3_-_2_76027381-95108573\n",
      "writing file bl6_rep1_data/Blocks/chr3_-_3_95110280-108445254\n",
      "writing file bl6_rep1_data/Blocks/chr3_-_4_108457415-135439806\n",
      "writing file bl6_rep1_data/Blocks/chr3_-_5_135445306-159937472\n",
      "writing file bl6_rep1_data/Blocks/chr13_+_0_3043616-34078000\n",
      "writing file bl6_rep1_data/Blocks/chr13_+_1_34114450-55135159\n",
      "writing file bl6_rep1_data/Blocks/chr13_+_2_55137195-77215136\n",
      "writing file bl6_rep1_data/Blocks/chr13_+_3_77216392-100643623\n",
      "writing file bl6_rep1_data/Blocks/chr13_+_4_100644983-120304375\n",
      "writing file bl6_rep1_data/Blocks/chr17_-_0_3040730-25015828\n",
      "writing file bl6_rep1_data/Blocks/chr17_-_1_25033085-34851001\n",
      "writing file bl6_rep1_data/Blocks/chr17_-_2_34852324-56167103\n",
      "writing file bl6_rep1_data/Blocks/chr17_-_3_56171468-74329941\n",
      "writing file bl6_rep1_data/Blocks/chr17_-_4_74332303-94864588\n",
      "writing file bl6_rep1_data/Blocks/chr7_-_0_3013378-27929500\n",
      "writing file bl6_rep1_data/Blocks/chr7_-_1_27933830-45275985\n",
      "writing file bl6_rep1_data/Blocks/chr7_-_2_45288031-79149113\n",
      "writing file bl6_rep1_data/Blocks/chr7_-_3_79280376-99125744\n",
      "writing file bl6_rep1_data/Blocks/chr7_-_4_99127508-114562981\n",
      "writing file bl6_rep1_data/Blocks/chr7_-_5_114595903-132317223\n",
      "writing file bl6_rep1_data/Blocks/chr7_-_6_132358755-145330562\n",
      "writing file bl6_rep1_data/Blocks/chr18_+_0_3142357-31785570\n",
      "writing file bl6_rep1_data/Blocks/chr18_+_1_31788435-44894928\n",
      "writing file bl6_rep1_data/Blocks/chr18_+_2_45029532-67322985\n",
      "writing file bl6_rep1_data/Blocks/chr18_+_3_67325089-90600827\n",
      "writing file bl6_rep1_data/Blocks/chr8_-_0_3080157-34147432\n",
      "writing file bl6_rep1_data/Blocks/chr8_-_1_34152546-70477017\n",
      "writing file bl6_rep1_data/Blocks/chr8_-_2_70481582-86746124\n",
      "writing file bl6_rep1_data/Blocks/chr8_-_3_86756517-111744763\n",
      "writing file bl6_rep1_data/Blocks/chr8_-_4_111746813-129292849\n",
      "writing file bl6_rep1_data/Blocks/chr8_+_0_3118907-26989109\n",
      "writing file bl6_rep1_data/Blocks/chr8_+_1_26992106-69872601\n",
      "writing file bl6_rep1_data/Blocks/chr8_+_2_69887316-86045509\n",
      "writing file bl6_rep1_data/Blocks/chr8_+_3_86046798-106439606\n",
      "writing file bl6_rep1_data/Blocks/chr8_+_4_106442053-120058902\n",
      "writing file bl6_rep1_data/Blocks/chr8_+_5_120059916-129294109\n",
      "writing file bl6_rep1_data/Blocks/chr7_+_0_3102161-27917135\n",
      "writing file bl6_rep1_data/Blocks/chr7_+_1_27918143-49613181\n",
      "writing file bl6_rep1_data/Blocks/chr7_+_2_49615091-80092768\n",
      "writing file bl6_rep1_data/Blocks/chr7_+_3_80093772-98539553\n",
      "writing file bl6_rep1_data/Blocks/chr7_+_4_98541731-112910460\n",
      "writing file bl6_rep1_data/Blocks/chr7_+_5_112911583-130770306\n",
      "writing file bl6_rep1_data/Blocks/chr7_+_6_130771651-145326029\n"
     ]
    }
   ],
   "source": [
    "total = 0\n",
    "files = glob.glob(root_dir+\"/*.txt\")\n",
    "info = open(root_dir+'/Blocks/info.txt','w')\n",
    "info.write('ID\\tstart\\tend\\tlength\\tsites_num\\n')\n",
    "for file in files:\n",
    "    num_lines = sum(1 for line in open(file))\n",
    "    num_blocks = round(num_lines/Fixed_length)\n",
    "    len_blocks = num_lines/num_blocks\n",
    "    \n",
    "    f= open(file,'r')\n",
    "    pre_pos = 0\n",
    "    dict_line = OrderedDict()\n",
    "    #dict_line = dict()\n",
    "    count = 0\n",
    "    separate_num=0\n",
    "    save_block = 0\n",
    "    start = 0\n",
    "    \n",
    "    for i, line in enumerate(f):\n",
    "        line = line.rstrip('\\n')\n",
    "        if(i==0):\n",
    "            continue ###Skip header\n",
    "        chromosome,pos,strand = line.split('\\t')[0].split(':')\n",
    "        pos = int(pos)\n",
    "        count += 1\n",
    "        if(i==1):\n",
    "            start=pos\n",
    "        if(count>len_blocks and pos-pre_pos>1000 and save_block<num_blocks-1):\n",
    "            array = Gene_Loc[chromosome+strand]\n",
    "            index1,index2 = binary_locate(array,pre_pos,0,len(array)-1)\n",
    "            if(index1%2==1 and index2%2==0):\n",
    "                ww = open(root_dir+'/Blocks/%s_%s_%d'%(chromosome,strand,save_block),'w')\n",
    "                print('writing file '+root_dir+'/Blocks/%s_%s_%d_%d-%d'%(chromosome,strand,save_block,start,pre_pos))\n",
    "                info.write('%s_%s_%d\\t%d\\t%d\\t%d\\t%d\\n'%(chromosome,strand,save_block,start,pre_pos,pre_pos-start,count))\n",
    "                #print('%s_%s_%d\\t%d\\t%d\\t%d\\t%d\\n'%(chromosome,strand,save_block,start,pre_pos,pre_pos-start,count))\n",
    "                for key,val in dict_line.items():\n",
    "                    ww.write('%s\\n'%val)\n",
    "                ww.close()\n",
    "                dict_line.clear()\n",
    "                count = 0\n",
    "                save_block += 1\n",
    "                start  = pos\n",
    "            \n",
    "        \n",
    "        dict_line[pos] = line\n",
    "        pre_pos = pos\n",
    "        \n",
    "    out = open(root_dir+'/Blocks/%s_%s_%d'%(chromosome,strand,save_block),'w')\n",
    "    print('writing file '+root_dir+'/Blocks/%s_%s_%d_%d-%d'%(chromosome,strand,save_block,start,pre_pos))\n",
    "    info.write('%s_%s_%d\\t%d\\t%d\\t%d\\t%d\\n'%(chromosome,strand,save_block,start,pre_pos,pre_pos-start,count))\n",
    "    for key,val in dict_line.items():\n",
    "        out.write('%s\\n'%(val))\n",
    "    out.close()\n",
    "\n",
    "info.close()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
